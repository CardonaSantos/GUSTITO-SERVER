generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Reparacion {
  id              Int                  @id @default(autoincrement())
  usuarioId       Int
  sucursalId      Int
  clienteId       Int
  productoId      Int?
  productoExterno String?
  problemas       String
  observaciones   String?
  fechaRecibido   DateTime             @default(now())
  fechaEntregado  DateTime?
  estado          EstadoReparacion     @default(PENDIENTE)
  hojaSolucion    String?
  creadoEn        DateTime             @default(now())
  actualizadoEn   DateTime             @updatedAt
  registros       RegistroReparacion[]
  cliente         Cliente              @relation(fields: [clienteId], references: [id], onDelete: Cascade)
  producto        Producto?            @relation(fields: [productoId], references: [id])
  sucursal        Sucursal             @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  usuario         Usuario              @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
}

model RegistroReparacion {
  id                 Int              @id @default(autoincrement())
  reparacionId       Int
  usuarioId          Int
  estado             EstadoReparacion
  accionesRealizadas String
  fechaRegistro      DateTime         @default(now())
  comentarioFinal    String?
  montoPagado        Int?
  reparacion         Reparacion       @relation(fields: [reparacionId], references: [id], onDelete: Cascade)
  usuario            Usuario          @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
}

model VentaCuota {
  id                   Int         @id @default(autoincrement())
  clienteId            Int
  usuarioId            Int
  sucursalId           Int
  totalVenta           Float
  cuotaInicial         Float
  cuotasTotales        Int
  fechaInicio          DateTime    @default(now())
  estado               EstadoCuota @default(ACTIVA)
  creadoEn             DateTime    @default(now())
  actualizadoEn        DateTime    @updatedAt
  dpi                  String
  testigos             Json
  fechaContrato        DateTime    @default(now())
  montoVenta           Float
  garantiaMeses        Int
  totalPagado          Float       @default(0)
  diasEntrePagos       Int         @default(0)
  interes              Int         @default(0)
  comentario           String?
  ventaId              Int?        @unique
  montoTotalConInteres Int?
  cuotas               Cuota[]
  cliente              Cliente     @relation(fields: [clienteId], references: [id], onDelete: Cascade)
  sucursal             Sucursal    @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  usuario              Usuario     @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  venta                Venta?      @relation(fields: [ventaId], references: [id], onDelete: Cascade)
}

model Cuota {
  id               Int        @id @default(autoincrement())
  ventaCuotaId     Int
  monto            Float
  fechaVencimiento DateTime?
  fechaPago        DateTime?
  estado           EstadoPago @default(PENDIENTE)
  usuarioId        Int?
  creadoEn         DateTime   @default(now())
  actualizadoEn    DateTime   @updatedAt
  comentario       String?
  montoEsperado    Float?
  usuario          Usuario?   @relation(fields: [usuarioId], references: [id])
  ventaCuota       VentaCuota @relation(fields: [ventaCuotaId], references: [id], onDelete: Cascade)
}

model PlantillaComprobante {
  id            Int       @id @default(autoincrement())
  nombre        String
  texto         String
  sucursalId    Int?
  creadoEn      DateTime  @default(now())
  actualizadoEn DateTime  @updatedAt
  sucursal      Sucursal? @relation(fields: [sucursalId], references: [id])
}

model VentaEliminada {
  id                     Int                      @id @default(autoincrement())
  usuarioId              Int
  motivo                 String
  totalVenta             Float
  clienteId              Int?
  fechaEliminacion       DateTime                 @default(now())
  sucursalId             Int
  cliente                Cliente?                 @relation(fields: [clienteId], references: [id])
  sucursal               Sucursal                 @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  usuario                Usuario                  @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  VentaEliminadaProducto VentaEliminadaProducto[]
}

model VentaEliminadaProducto {
  id               Int            @id @default(autoincrement())
  ventaEliminadaId Int
  productoId       Int?
  cantidad         Int
  precioVenta      Float
  creadoEn         DateTime       @default(now())
  producto         Producto?      @relation(fields: [productoId], references: [id])
  ventaEliminada   VentaEliminada @relation(fields: [ventaEliminadaId], references: [id], onDelete: Cascade)
}

model SucursalSaldo {
  id             Int      @id @default(autoincrement())
  sucursalId     Int      @unique
  saldoAcumulado Float    @default(0)
  totalIngresos  Float    @default(0)
  totalEgresos   Float    @default(0)
  actualizadoEn  DateTime @updatedAt
  sucursal       Sucursal @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
}

model RegistroCaja {
  id           Int         @id @default(autoincrement())
  sucursalId   Int?
  usuarioId    Int?
  saldoInicial Float?
  saldoFinal   Float?      @default(0)
  fechaInicio  DateTime?   @default(now())
  fechaCierre  DateTime?   @default(now())
  estado       EstadoCaja? @default(ABIERTO)
  comentario   String?
  depositos    Deposito[]
  egresos      Egreso[]
  sucursal     Sucursal?   @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  usuario      Usuario?    @relation(fields: [usuarioId], references: [id])
  ventas       Venta[]
}

model SucursalSaldoGlobal {
  id            Int      @id @default(autoincrement())
  saldoGlobal   Float    @default(0)
  totalIngresos Float    @default(0)
  totalEgresos  Float    @default(0)
  actualizadoEn DateTime @updatedAt
}

model Deposito {
  id              Int           @id @default(autoincrement())
  registroCajaId  Int?
  monto           Float
  numeroBoleta    String
  banco           String
  fechaDeposito   DateTime      @default(now())
  usadoParaCierre Boolean       @default(false)
  descripcion     String?
  sucursalId      Int?
  usuarioId       Int?
  registroCaja    RegistroCaja? @relation(fields: [registroCajaId], references: [id])
  sucursal        Sucursal?     @relation(fields: [sucursalId], references: [id])
  usuario         Usuario?      @relation(fields: [usuarioId], references: [id])
}

model Egreso {
  id             Int           @id @default(autoincrement())
  registroCajaId Int?
  descripcion    String?
  monto          Float
  fechaEgreso    DateTime      @default(now())
  sucursalId     Int?
  usuarioId      Int?
  registroCaja   RegistroCaja? @relation(fields: [registroCajaId], references: [id])
  sucursal       Sucursal?     @relation(fields: [sucursalId], references: [id])
  usuario        Usuario?      @relation(fields: [usuarioId], references: [id])
}

model TicketSorteo {
  id                Int          @id @default(autoincrement())
  descripcionSorteo String?
  creadoEn          DateTime     @default(now())
  actualizadoEn     DateTime     @updatedAt
  estado            EstadoTicket
}

model Vencimiento {
  id               Int               @id @default(autoincrement())
  fechaVencimiento DateTime
  estado           EstadoVencimiento @default(PENDIENTE)
  descripcion      String?
  stockId          Int?
  fechaCreacion    DateTime          @default(now())
  stock            Stock?            @relation(fields: [stockId], references: [id])
}

model Notificacion {
  id                     Int                      @id @default(autoincrement())
  mensaje                String
  remitenteId            Int?
  tipoNotificacion       TipoNotificacion
  referenciaId           Int?
  fechaCreacion          DateTime                 @default(now())
  remitente              Usuario?                 @relation("Remitente", fields: [remitenteId], references: [id])
  notificacionesUsuarios NotificacionesUsuarios[]
  Usuario                Usuario[]                @relation("Destinatario")
}

model NotificacionesUsuarios {
  id             Int          @id @default(autoincrement())
  usuarioId      Int
  notificacionId Int
  leido          Boolean      @default(false)
  eliminado      Boolean      @default(false)
  leidoEn        DateTime?
  recibidoEn     DateTime     @default(now())
  notificacion   Notificacion @relation(fields: [notificacionId], references: [id], onDelete: Cascade)
  usuario        Usuario      @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
}

model SolicitudPrecio {
  id               Int             @id @default(autoincrement())
  productoId       Int
  precioSolicitado Float
  solicitadoPorId  Int
  estado           EstadoSolicitud @default(PENDIENTE)
  aprobadoPorId    Int?
  fechaSolicitud   DateTime        @default(now())
  fechaRespuesta   DateTime?
  aprobadoPor      Usuario?        @relation("AprobadoPor", fields: [aprobadoPorId], references: [id])
  producto         Producto        @relation(fields: [productoId], references: [id], onDelete: Cascade)
  solicitadoPor    Usuario         @relation("SolicitadoPor", fields: [solicitadoPorId], references: [id])
}

model Producto {
  id                       Int                              @id @default(autoincrement())
  nombre                   String
  descripcion              String?
  codigoProducto           String                           @unique
  creadoEn                 DateTime                         @default(now())
  actualizadoEn            DateTime                         @updatedAt
  precioCostoActual        Float?
  deletedAt                DateTime?
  isDeleted                Boolean                          @default(false)
  AjusteStock              AjusteStock[]
  EliminacionProducto      EliminacionProducto[]
  EliminacionStock         EliminacionStock[]
  Garantia                 Garantia[]
  HistorialPrecio          HistorialPrecio[]
  HistorialPrecioCosto     HistorialPrecioCosto[]
  HistorialStock           HistorialStock[]
  precios                  PrecioProducto[]
  RegistroGarantia         RegistroGarantia[]
  Reparacion               Reparacion[]
  SolicitudPrecio          SolicitudPrecio[]
  solicitudesTransferencia SolicitudTransferenciaProducto[]
  stock                    Stock[]
  TransferenciaProducto    TransferenciaProducto[]
  VentaEliminadaProducto   VentaEliminadaProducto[]
  ventas                   VentaProducto[]
  categorias               Categoria[]                      @relation("CategoriaToProducto")
}

model Empaque {
  id               Int                @id @default(autoincrement())
  nombre           String
  descripcion      String
  codigoProducto   String             @unique
  creadoEn         DateTime           @default(now())
  actualizadoEn    DateTime           @updatedAt
  precioCosto      Float?
  precioVenta      Float?
  deletedAt        DateTime?
  isDeleted        Boolean            @default(false)
  AjusteStock      AjusteStock[]
  EliminacionStock EliminacionStock[]
  HistorialStock   HistorialStock[]
  stock            Stock[]
}

model HistorialPrecioCosto {
  id                  Int      @id @default(autoincrement())
  productoId          Int
  precioCostoAnterior Float
  precioCostoNuevo    Float
  fechaCambio         DateTime @default(now())
  modificadoPorId     Int?
  modificadoPor       Usuario? @relation(fields: [modificadoPorId], references: [id], onDelete: Cascade)
  producto            Producto @relation(fields: [productoId], references: [id], onDelete: Cascade)
}

model PrecioProducto {
  id            Int          @id @default(autoincrement())
  productoId    Int?
  precio        Float
  creadoPorId   Int?
  orden         Int?
  fechaCreacion DateTime     @default(now())
  estado        EstadoPrecio
  usado         Boolean      @default(false)
  tipo          TipoPrecio
  creadoPor     Usuario?     @relation(fields: [creadoPorId], references: [id])
  producto      Producto?    @relation(fields: [productoId], references: [id], onDelete: Cascade)
}

model HistorialPrecio {
  id             Int      @id @default(autoincrement())
  productoId     Int
  precioAnterior Float
  precioNuevo    Float
  fechaCambio    DateTime @default(now())
  producto       Producto @relation(fields: [productoId], references: [id], onDelete: Cascade)
}

model AjusteStock {
  id               Int        @id @default(autoincrement())
  productoId       Int?
  empaqueId        Int?
  stockId          Int?
  cantidadAjustada Int
  tipoAjuste       TipoAjuste
  fechaHora        DateTime   @default(now())
  usuarioId        Int?
  descripcion      String?
  empaque          Empaque?   @relation(fields: [empaqueId], references: [id])
  producto         Producto?  @relation(fields: [productoId], references: [id])
  stock            Stock?     @relation(fields: [stockId], references: [id])
  usuario          Usuario?   @relation(fields: [usuarioId], references: [id])
}

model EliminacionStock {
  id         Int       @id @default(autoincrement())
  productoId Int?
  empaqueId  Int?
  fechaHora  DateTime  @default(now())
  usuarioId  Int?
  sucursalId Int?
  motivo     String?
  empaque    Empaque?  @relation(fields: [empaqueId], references: [id])
  producto   Producto? @relation(fields: [productoId], references: [id])
  sucursal   Sucursal? @relation(fields: [sucursalId], references: [id])
  usuario    Usuario?  @relation(fields: [usuarioId], references: [id])
}

model EliminacionProducto {
  id         Int      @id @default(autoincrement())
  productoId Int
  fechaHora  DateTime @default(now())
  usuarioId  Int?
  motivo     String?
  producto   Producto @relation(fields: [productoId], references: [id])
  usuario    Usuario? @relation(fields: [usuarioId], references: [id])
}

model EliminacionCliente {
  id        Int      @id @default(autoincrement())
  clienteId Int
  fechaHora DateTime @default(now())
  usuarioId Int?
  motivo    String?
  cliente   Cliente  @relation(fields: [clienteId], references: [id])
  usuario   Usuario? @relation(fields: [usuarioId], references: [id])
}

model Stock {
  id               Int           @id @default(autoincrement())
  productoId       Int?
  empaqueId        Int?
  cantidad         Int
  costoTotal       Float
  creadoEn         DateTime      @default(now())
  fechaIngreso     DateTime
  fechaVencimiento DateTime?
  precioCosto      Float
  sucursalId       Int
  entregaStockId   Int?
  cantidadInicial  Int?
  AjusteStock      AjusteStock[]
  empaque          Empaque?      @relation(fields: [empaqueId], references: [id], onDelete: Cascade)
  entregaStock     EntregaStock? @relation(fields: [entregaStockId], references: [id])
  producto         Producto?     @relation(fields: [productoId], references: [id], onDelete: Cascade)
  sucursal         Sucursal      @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  Vencimiento      Vencimiento[]
}

model Sucursal {
  id                           Int                              @id @default(autoincrement())
  nombre                       String
  direccion                    String?
  telefono                     String?
  pbx                          String?
  creadoEn                     DateTime                         @default(now())
  actualizadoEn                DateTime                         @updatedAt
  tipoSucursal                 TipoSucursal
  estadoOperacion              Boolean                          @default(true)
  Deposito                     Deposito[]
  DepositoCobro                DepositoCobro[]
  Egreso                       Egreso[]
  EliminacionStock             EliminacionStock[]
  EntregaStock                 EntregaStock[]
  MetaCobros                   MetaCobros[]
  MetaUsuario                  MetaUsuario[]
  PlantillaComprobante         PlantillaComprobante[]
  RegistroCaja                 RegistroCaja[]
  Reparacion                   Reparacion[]
  solicitudesDestino           SolicitudTransferenciaProducto[] @relation("SucursalDestinoSolicitud")
  solicitudesOrigen            SolicitudTransferenciaProducto[] @relation("SucursalOrigenSolicitud")
  productos                    Stock[]
  SucursalSaldo                SucursalSaldo?
  TransferenciaProductoDestino TransferenciaProducto[]          @relation("SucursalDestino")
  TransferenciaProducto        TransferenciaProducto[]          @relation("SucursalOrigen")
  usuarios                     Usuario[]
  Venta                        Venta[]
  VentaCuota                   VentaCuota[]
  VentaEliminada               VentaEliminada[]
}

model EntregaStock {
  id              Int        @id @default(autoincrement())
  proveedorId     Int?
  montoTotal      Float
  fechaEntrega    DateTime   @default(now())
  recibidoPorId   Int?
  sucursalId      Int?
  proveedor       Proveedor? @relation(fields: [proveedorId], references: [id])
  usuarioRecibido Usuario?   @relation("UsuarioRecibido", fields: [recibidoPorId], references: [id])
  sucursal        Sucursal?  @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  stockEntregado  Stock[]
}

model Usuario {
  id                                Int                              @id @default(autoincrement())
  nombre                            String
  rol                               Rol
  contrasena                        String
  activo                            Boolean                          @default(true)
  correo                            String                           @unique
  sucursalId                        Int
  fecha_creacion                    DateTime                         @default(now())
  fecha_actualizacion               DateTime                         @default(now())
  AjusteStock                       AjusteStock[]
  Cuota                             Cuota[]
  Deposito                          Deposito[]
  DepositoCobro                     DepositoCobro[]
  Egreso                            Egreso[]
  EliminacionCliente                EliminacionCliente[]
  EliminacionProducto               EliminacionProducto[]
  EliminacionStock                  EliminacionStock[]
  entregasRecibidas                 EntregaStock[]                   @relation("UsuarioRecibido")
  Garantia                          Garantia[]
  HistorialPrecioCosto              HistorialPrecioCosto[]
  MetaCobros                        MetaCobros[]
  MetaUsuario                       MetaUsuario[]
  notificacionesEnviadas            Notificacion[]                   @relation("Remitente")
  notificacionesUsuarios            NotificacionesUsuarios[]
  PrecioProducto                    PrecioProducto[]
  RegistroCaja                      RegistroCaja[]
  RegistroGarantia                  RegistroGarantia[]
  RegistroReparacion                RegistroReparacion[]
  Reparacion                        Reparacion[]
  solicitudesAprobadas              SolicitudPrecio[]                @relation("AprobadoPor")
  solicitudesPrecio                 SolicitudPrecio[]                @relation("SolicitadoPor")
  solicitudesAprobadasTransferencia SolicitudTransferenciaProducto[] @relation("AdministradorAprobador")
  solicitudesEnviadas               SolicitudTransferenciaProducto[] @relation("UsuarioSolicitante")
  TransferenciaProducto             TransferenciaProducto[]
  sucursal                          Sucursal                         @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  ventas                            Venta[]
  VentaCuota                        VentaCuota[]
  VentaEliminada                    VentaEliminada[]
  notificacionesRecibidas           Notificacion[]                   @relation("Destinatario")
}

model MetaUsuario {
  id            Int              @id @default(autoincrement())
  usuarioId     Int
  sucursalId    Int
  fechaInicio   DateTime         @default(now())
  fechaFin      DateTime
  montoMeta     Float
  montoActual   Float            @default(0)
  cumplida      Boolean          @default(false)
  fechaCumplida DateTime?
  numeroVentas  Float
  tituloMeta    String?
  estado        EstadoMetaTienda
  sucursal      Sucursal         @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  usuario       Usuario          @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
}

model MetaCobros {
  id              Int             @id @default(autoincrement())
  usuarioId       Int
  sucursalId      Int
  fechaCreado     DateTime        @default(now())
  fechaInicio     DateTime        @default(now())
  fechaFin        DateTime
  montoMeta       Float
  montoActual     Float           @default(0)
  cumplida        Boolean         @default(false)
  fechaCumplida   DateTime?
  numeroDepositos Int             @default(0)
  tituloMeta      String?
  estado          EstadoMetaCobro
  DepositoCobro   DepositoCobro[]
  sucursal        Sucursal        @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  usuario         Usuario         @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
}

model DepositoCobro {
  id              Int        @id @default(autoincrement())
  usuarioId       Int
  sucursalId      Int
  numeroBoleta    String
  fechaRegistro   DateTime   @default(now())
  montoDepositado Float
  descripcion     String?
  metaCobroId     Int
  metaCobro       MetaCobros @relation(fields: [metaCobroId], references: [id], onDelete: Cascade)
  sucursal        Sucursal   @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  usuario         Usuario    @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
}

model Cliente {
  id                 Int                  @id @default(autoincrement())
  nombre             String
  telefono           String?
  direccion          String?
  creadoEn           DateTime             @default(now())
  actualizadoEn      DateTime             @updatedAt
  municipioId        Int?
  departamentoId     Int?
  dpi                String?
  iPInternet         String?
  departamento       Departamento?        @relation(fields: [departamentoId], references: [id])
  municipio          Municipio?           @relation(fields: [municipioId], references: [id])
  EliminacionCliente EliminacionCliente[]
  Garantia           Garantia[]
  Reparacion         Reparacion[]
  compras            Venta[]
  VentaCuota         VentaCuota[]
  VentaEliminada     VentaEliminada[]

  @@unique([dpi, id])
}

model Garantia {
  id                  Int                @id @default(autoincrement())
  clienteId           Int
  productoId          Int
  usuarioIdRecibe     Int?
  comentario          String?
  descripcionProblema String
  fechaRecepcion      DateTime           @default(now())
  estado              EstadoGarantia     @default(RECIBIDO)
  creadoEn            DateTime           @default(now())
  actualizadoEn       DateTime           @updatedAt
  proveedorId         Int?
  cliente             Cliente            @relation(fields: [clienteId], references: [id], onDelete: Cascade)
  producto            Producto           @relation(fields: [productoId], references: [id], onDelete: Cascade)
  proveedor           Proveedor?         @relation(fields: [proveedorId], references: [id])
  usuarioRecibe       Usuario?           @relation(fields: [usuarioIdRecibe], references: [id])
  registros           RegistroGarantia[]
}

model RegistroGarantia {
  id                 Int            @id @default(autoincrement())
  garantiaId         Int
  usuarioId          Int?
  productoId         Int
  estado             EstadoGarantia
  conclusion         String?
  accionesRealizadas String?
  fechaRegistro      DateTime       @default(now())
  proveedorId        Int?
  garantia           Garantia       @relation(fields: [garantiaId], references: [id], onDelete: Cascade)
  producto           Producto       @relation(fields: [productoId], references: [id], onDelete: Cascade)
  proveedor          Proveedor?     @relation(fields: [proveedorId], references: [id])
  usuario            Usuario?       @relation(fields: [usuarioId], references: [id])
}

model Pago {
  id         Int        @id @default(autoincrement())
  ventaId    Int        @unique
  monto      Float
  metodoPago MetodoPago
  fechaPago  DateTime   @default(now())
  venta      Venta      @relation(fields: [ventaId], references: [id], onDelete: Cascade)
}

model HistorialStock {
  id               Int       @id @default(autoincrement())
  productoId       Int?
  empaqueId        Int?
  cantidadAnterior Int
  cantidadNueva    Int
  fechaCambio      DateTime  @default(now())
  empaque          Empaque?  @relation(fields: [empaqueId], references: [id], onDelete: Cascade)
  producto         Producto? @relation(fields: [productoId], references: [id], onDelete: Cascade)
}

model Venta {
  id                    Int             @id @default(autoincrement())
  clienteId             Int?
  fechaVenta            DateTime        @default(now())
  horaVenta             DateTime        @default(now())
  totalVenta            Float
  sucursalId            Int
  nombreClienteFinal    String?
  telefonoClienteFinal  String?
  direccionClienteFinal String?
  imei                  String?
  registroCajaId        Int?
  usuarioId             Int?
  metodoPago            Pago?
  cliente               Cliente?        @relation(fields: [clienteId], references: [id])
  registroCaja          RegistroCaja?   @relation(fields: [registroCajaId], references: [id])
  sucursal              Sucursal        @relation(fields: [sucursalId], references: [id], onDelete: Cascade)
  usuario               Usuario?        @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  ventaCuota            VentaCuota?
  productos             VentaProducto[]

  @@unique([imei, id])
}

model TransferenciaProducto {
  id                 Int      @id @default(autoincrement())
  productoId         Int
  cantidad           Int
  sucursalOrigenId   Int
  sucursalDestinoId  Int
  fechaTransferencia DateTime @default(now())
  usuarioEncargadoId Int?
  producto           Producto @relation(fields: [productoId], references: [id], onDelete: Cascade)
  sucursalDestino    Sucursal @relation("SucursalDestino", fields: [sucursalDestinoId], references: [id], onDelete: Cascade)
  sucursalOrigen     Sucursal @relation("SucursalOrigen", fields: [sucursalOrigenId], references: [id], onDelete: Cascade)
  usuarioEncargado   Usuario? @relation(fields: [usuarioEncargadoId], references: [id])
}

model SolicitudTransferenciaProducto {
  id                   Int                          @id @default(autoincrement())
  productoId           Int
  cantidad             Int
  sucursalOrigenId     Int
  sucursalDestinoId    Int
  usuarioSolicitanteId Int?
  estado               EstadoSolicitudTransferencia @default(PENDIENTE)
  fechaSolicitud       DateTime                     @default(now())
  fechaAprobacion      DateTime?
  administradorId      Int?
  administrador        Usuario?                     @relation("AdministradorAprobador", fields: [administradorId], references: [id])
  producto             Producto                     @relation(fields: [productoId], references: [id], onDelete: Cascade)
  sucursalDestino      Sucursal                     @relation("SucursalDestinoSolicitud", fields: [sucursalDestinoId], references: [id], onDelete: Cascade)
  sucursalOrigen       Sucursal                     @relation("SucursalOrigenSolicitud", fields: [sucursalOrigenId], references: [id], onDelete: Cascade)
  usuarioSolicitante   Usuario?                     @relation("UsuarioSolicitante", fields: [usuarioSolicitanteId], references: [id])
}

model VentaProducto {
  id          Int       @id @default(autoincrement())
  ventaId     Int
  productoId  Int?
  cantidad    Int
  creadoEn    DateTime  @default(now())
  precioVenta Float
  producto    Producto? @relation(fields: [productoId], references: [id])
  venta       Venta     @relation(fields: [ventaId], references: [id], onDelete: Cascade)
}

model Proveedor {
  id               Int                @id @default(autoincrement())
  nombre           String
  correo           String?
  telefono         String?
  direccion        String?
  razonSocial      String?
  rfc              String?
  nombreContacto   String?
  telefonoContacto String?
  emailContacto    String?
  pais             String?
  ciudad           String?
  codigoPostal     String?
  latitud          Float?
  longitud         Float?
  activo           Boolean            @default(true)
  notas            String?
  creadoEn         DateTime           @default(now())
  actualizadoEn    DateTime           @updatedAt
  entregasStock    EntregaStock[]
  Garantia         Garantia[]
  RegistroGarantia RegistroGarantia[]
}

model Categoria {
  id        Int        @id @default(autoincrement())
  nombre    String     @unique
  productos Producto[] @relation("CategoriaToProducto")
}

model Departamento {
  id         Int         @id @default(autoincrement())
  nombre     String      @unique
  clientes   Cliente[]
  municipios Municipio[]
}

model Municipio {
  id             Int          @id @default(autoincrement())
  nombre         String       @unique
  departamentoId Int
  clientes       Cliente[]
  departamento   Departamento @relation(fields: [departamentoId], references: [id], onDelete: Cascade)
}

enum EstadoReparacion {
  RECIBIDO
  PENDIENTE
  EN_PROCESO
  ESPERANDO_PIEZAS
  REPARADO
  ENTREGADO
  CANCELADO
  NO_REPARABLE
  FINALIZADO
}

enum EstadoPago {
  PENDIENTE
  PAGADA
  ATRASADA
}

enum EstadoCuota {
  ACTIVA
  COMPLETADA
  CANCELADA
}

enum EstadoCaja {
  ABIERTO
  CERRADO
}

enum EstadoTicket {
  ACTIVO
  INACTIVO
}

enum EstadoVencimiento {
  PENDIENTE
  NOTIFICADO
  RESUELTO
}

enum TipoAjuste {
  INCREMENTO
  DECREMENTO
  CORRECCION
}

enum EstadoMetaCobro {
  CANCELADO
  ABIERTO
  FINALIZADO
  CERRADO
}

enum EstadoMetaTienda {
  CANCELADO
  ABIERTO
  FINALIZADO
  CERRADO
}

enum EstadoGarantia {
  RECIBIDO
  ENVIADO_A_PROVEEDOR
  EN_REPARACION
  REPARADO
  REEMPLAZADO
  ENTREGADO_CLIENTE
  CERRADO
}

enum Rol {
  ADMIN
  MANAGER
  VENDEDOR
  SUPER_ADMIN
}

enum TipoSucursal {
  TIENDA
  ALMACEN
  CENTRO_DISTRIBUCION
  TALLER
  OFICINA
}

enum MetodoPago {
  CONTADO
  TARJETA
  TRANSFERENCIA
  PAYPAL
  OTRO
  CUTOAS
  CREDITO
}

enum TipoPrecio {
  CREADO_POR_SOLICITUD
  ESTANDAR
}

enum EstadoPrecio {
  APROBADO
  PENDIENTE
  RECHAZADO
}

enum TipoNotificacion {
  SOLICITUD_PRECIO
  TRANSFERENCIA
  VENCIMIENTO
  OTRO
}

enum EstadoNotificacion {
  NO_LEIDO
  LEIDO
}

enum EstadoSolicitud {
  PENDIENTE
  APROBADO
  RECHAZADO
}

enum EstadoSolicitudTransferencia {
  PENDIENTE
  APROBADO
  RECHAZADO
}
